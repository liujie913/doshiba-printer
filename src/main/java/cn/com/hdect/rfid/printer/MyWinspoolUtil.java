package cn.com.hdect.rfid.printer;

import com.sun.jna.platform.win32.WinNT;
import com.sun.jna.platform.win32.Winspool;

import java.nio.charset.StandardCharsets;

public class MyWinspoolUtil {

    public static void main(String[] args) {
        String name = "TOSHIBA BA400 (300 dpi)";
        WinNT.HANDLEByReference handle =  new WinNT.HANDLEByReference();
        boolean opened = MyWinspool.INSTANCE.OpenPrinter(name, handle, null);
        System.out.println(opened);

        Winspool.JOB_INFO_1 doc = new Winspool.JOB_INFO_1();
        doc.pDocument = "标签打印";
        doc.pDatatype = "RAW";
        try {
            boolean b1 = MyWinspool.INSTANCE.StartDocPrinter(handle.getValue(), 1,  doc);
            boolean b2 =MyWinspool.INSTANCE.StartPagePrinter(handle.getValue());
            String commandStatus = "{WF;A000,T24,I4,U1|}"; // 打印机状态
            String commandBackFeed = "{U2;0150|}"; // 向后进纸
            String commandRead = "{WF;A000,T24,I4,U1|}"; // 读取标签
//            String commandWriteAndLock = "{@012;w,G2=TID,R12345678,L00300|}"; // 写入并锁定
            String commandBeforeFeed = "{U1;0150|}"; // 向前进纸
            String commandTagSize = "{D0321,0735,0301|}"; // 标签尺寸
            String commandAY = "{AY;+01,0|}"; // 打印温度
            String commandCleanCash = "{C|}"; // 清除缓存
//            String commandLogo = "{SG;0477,0104,0272,0208,0,?????800007?????????????????<000000007?????????????<00000000???????<?????800007??????????????????800000007?????????????<00000003???????<?????800007??????????????????>00000007?????????????<00000007???????<?????800007???????????????????00000007?????????????<0000003????????<?????800007???????????????????<0000007?????????????<0000007????????<?????800007???????????????????>0000007?????????????<000001?????????<?????800007????????????????????8000007?????????????<000001?????????<?????800007????????????????????<000007?????????????<000007?????????<?????800007????????????????????>000007?????????????<00000??????????<?????800007?????????????????????000007?????????????<00000??????????<?????800007?????????????????????800007?????????????<00003??????????<?????800007?????????????????????<00007?????????????<00007??????????<?????800007?????????????????????>00007?????????????<00007??????????<?????800007??????????????????????00007?????????????<0000???????????<?????800007??????????????????????00007?????????????<0001???????????<?????800007??????????????????????80007?????????????<0003???????????<?????800007??????????????????????<0007?????????????<0003???????????<?????800007??????????????????????<0007?????????????<0007???????????<?????800007??????????????????????>0007?????????????<000????????????<?????800007??????????????????????>0007?????????????<000????????????<?????800007???????????????????????0007?????????????<001????????????<?????800007???????????????????????8007?????????????<001????????????<?????800007???????????????????????8007?????????????<003????????????<?????800007???????????????????????<007?????????????<003????????????<?????800007???????????????????????<007?????????????<007????????????<?????800007???????????????????????>0030?????????8000007????????????8?????800007????>00000000000???????>0000000000000000000????????000000?????800007????<000000000003??????>0000000000000000000???????8000000?????800007????<000000000000???????0000000000000000001???????0000000?????800007????<0000000000007??????0000000000000000001??????<0000000?????800007????<0000000000003??????8000000000000000001??????80000000?????800007????<0000000000000??????8000000000000000003??????00000000?????800007????<00000000000007?????8000000000000000003?????>00000000?????800007????<00000000000007?????8000000000000000003?????<00000000?????800007????<00000000000003?????<000000000000000003?????<00000000?????800007????<00000000000001?????<000000000000000007?????800000000?????800007????<00000000000001?????<000000000000000007?????000000000?????800007????<00000000000000?????<000000000000000007????>000000000?????800007????<00000000000000?????>00000000000000000?????>000000000???????????????<03????80000000?????>03?????????????00?????<000000000???????????????<07????800000007????>07?????????????80?????<000000000???????????????<07????800000007????>07?????????????80?????<000000000???????????????<07????800000003?????07?????????????80?????8000000000???????????????<07????800000003?????07?????????????80?????8000000000???????????????<07????800000003?????07?????????????80?????8000000000???????????????<07????800000001?????07?????????????81?????0000000000???????????????<07????800000001?????07?????????????81?????0000000000???????????????<07????800000001?????07?????????????81?????0000000000???????????????<07????800000001?????07?????????????81?????0000000000???????????????<07????800000001?????07?????????????81?????0000000000???????????????<07????800000001?????07?????????????81????>0000000000???????????????<07????800000001?????07?????????????81????>0000000000???????????????<07????800000001?????87?????????????81????>0000000000???????????????<07????800000001?????87?????????????81????>0000000000???????????????<07????800000001?????07?????????????81????>0000000000???????????????<07????800000001?????07?????????????81????>0000000000???????????????<07????800000001?????07?????????????81????>0000000000???????????????<07????800000001?????07?????????????81?????0000000000???????????????<07????800000001?????07?????????????81?????0000000000???????????????<07????800000001?????07?????????????81?????0000000000???????????????<07????800000001?????07?????????????81?????0000000000???????????????<07????800000001?????07?????????????80?????8000000000???????????????<07????800000003?????07?????????????80?????8000000000???????????????<07????800000003?????07?????????????80?????8000000000???????????????<07????800000007????>07?????????????80?????8000000000???????????????<07????800000007????>07?????????????80?????<000000000???????????????<07????800000007????>07?????????????80?????<000000000?????80000?????<07????80000000?????>07????>0000000000?????>000000000?????800007????<07????80000000?????>07????<0000000000?????>000000000?????800007????<07????80000000?????<07????<00000000007?????000000000?????800007????<07????80000001?????<07????<00000000007?????000000000?????800007????<07????80000003?????<07????<00000000007?????800000018?????800007????<07????80000003?????<07????<00000000003?????<00000018?????800007????<07????80000007?????807????<00000000003?????>00000038?????800007????<07????8000000??????807????<00000000003?????>00000078?????800007????<07????8000001??????807????<00000000003??????000000?8?????800007????<07????8000007??????007????<00000000001??????800001?8?????800007????<07????800000???????007????<00000000001??????>00003?8?????800007????<07????<00001???????007????<00000000000???????00007?8?????800007????<07????<0000???????>007????<00000000000???????>003??8?????800007????<07????????????????>007?????????????0007????????????8?????800007????<07????????????????<007?????????????8007????????????8?????800007????<07????????????????<007?????????????8007????????????8?????800007????<07????????????????8007?????????????8003????????????8?????800007????<07????????????????8007?????????????8003????????????8?????800007????<07????????????????0007?????????????8001????????????8?????800007????<07????????????????0007?????????????8000????????????8?????800007????<07???????????????>0007?????????????8000????????????8?????800007????<07???????????????<0007?????????????80007???????????8?????800007????<07???????????????<0007?????????????80007???????????8?????800007????<07???????????????80007?????????????80003???????????8?????800007????<07???????????????00007?????????????80001???????????8?????800007????<07???????????????00007?????????????80001???????????8?????800007????<07??????????????>00007?????????????80000???????????8?????800007????<07??????????????<00007?????????????800007??????????8?????800007????<07??????????????800007?????????????800003??????????8?????800007????<07??????????????000007?????????????800001??????????8?????800007????<07?????????????>000007?????????????800000??????????8?????800007????<07?????????????<000007?????????????8000007?????????8?????800007????<07?????????????8000007?????????????8000003?????????8?????800007????<07?????????????0000007?????????????8000001?????????8?????800007????<07????????????>0000007?????????????80000007????????8?????800007????<07????????????80000007?????????????80000003????????8?????800007????<07????????????00000007?????????????80000000????????0?????800007????<07???????????<00000007?????????????800000007??????>0?????800007????<07???????????000000007?????????????800000001??????80?????800007????<07??????????8000000007?????????????8000000007????>00?????800003????<07?????????<0000000007?????????????80000000007???000?????000001????803????????800000000003?????????????000000000003>000080000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000803?0001?8000000000000002000000000000?>07?????????80003?00000001?800803?0001?8000000000000007>000000001?0?>07?????????80003?00000001?<00807?0001?8000000000000007>000000003?87>07?????????80003?00000001?<00807?0001?8000000000000007>000000001?87>07?????????80007?80000003?<00807>0001?80001?8000000007>000000001?8?>07?????????80???????????????<807>0001?80001?8000000007>000000001?8?>07?????????80???????????????<807>0001?80003?8000000007>000000001?8?>07?????????80???????????????<80?>0001?80003?8000000007>000000001?8?>03?????????00???????????????<80?<0001?80007?8000000007>000000001?8?>0000000000000???????????????<80?<0001?8003??0000000007>000000001?8?>0000000000000???????????????<81?<0001?800???0000000007>000000001?8?>0000000000000???????????????<81?<0001?80????0000000007>000000001?8?>0000000000000???????????????<83?80001?<????>0000000007>000000001?8?>00000000000007??????????????<87?80001??????>000000000??000000001?8?>0000000000000007?00000001?<008??80001??????<007??????????????>01?8?>0000000000000003?00000001?<00;??00007??????0007??????????????>01?8?>007???????800003?00000001?<00???0007??????>0007???????????????01?8?>00????????>00003?00000001?<00???00????????80007??????????????>01?8?>01????????>00003?00000001?<00???07???????800007??????????????>01?8?>01?????????00003>00000001?800???07??????8000007???????????????01?8?>03?????????000000000000000000???07?????80000007??????????????>01?8?>03?????????000000000000000000???07????<00000007??????????????>01?8?>03?????????000000000000000000???07????800000003??????????????<01?8?>03?????????000000000000000000?3?07????800000000000000??000000001?8?>03?8000007?000000000000000000<3?07?<1?800000000000000??000000001?8??03?0000003?0000003?003?001?8083?07>01?800000000000000??000000001?8???3?0000003?0000003?003?001?<083?02001?800000000000001??800000001?8???3?0000003?0007>03?003?001?<083?00001?800000000000001??800000001?8???3?0000003?0007>03?003?000?<083?00001?800000000000001??800000001?8???3?0000003?0007>03?003?000?<083?00001?800000000000001??800000001?8???3?0000003?000?>03?003?000?<083?00001?800000000000001??800000001?8???3?0000003?000?>03?003?000?<083?00001?800000000000003??<00000001?8???3?0000003?000?>03?003?000?<083?00001?800000000000003??<00000001?8???3?0000003?000?>03?003?000?<083?00001?<00000000000003??<00000001?8?>03?8000003?000?>03?003?000?<083?00001?>00000000000003??<00000001?8?>03?????????000?>03?003?000?<083?00001???????800000007??>00000001?8?>03?????????000?>03?003?000?<083?00001???????<00000007??>00000001?8?>03?????????000?>03?003?000?>083?00001???????<00000007??>00000001?8?>03?????????000?<03?003?800?>083?00000???????<00000007???00000001?8?>03?????????000?<03?003?800?>083?00000???????<0000000????00000001?8?>03?????????000?<03?003?8007>083?00000???????<0000000?>7?80000001?8?>03?????????000?<03?003?8007>083?000007??????<0000001?>7?80000001?8?>03?????????000?<03?003?8007>083?000001??????80000001?>7?80000001?8?>03?0000003?000?<03?003?8007>083?00000000000000000001?<3?80000001?8?>03?0000003?001?<03?003?8007>083?00000000000000000003?<3?<0000001?8?>03?0000003?001?<03?001?8007>081?0000?800000000000003?<1?<0000001?8?>03?0000003?001?<03?001?8007>08000000?<00000000000007?81?>0000001?8?>03?0000003?001?803?001?8007>08000000?<00000000000007?81?>0000001?8?>03?0000003?001?803?001?8007?08000000?<0000000000000??00??0000001?8?>03?0000003?001?803?001?8007?08000000?<0000000000000??00??0000001?8?>03?0000003?001?803?001?8007?08000000?<0000000000001??007?8000001?8?>03?0000003?001?803?001?8003?08000001?<0000000000003?>007?<000001?8?>03?0000003?001?803?001?8003?0???????????????8000003?>003?<000001?8?>03?8000007?003?803?001?8003?0???????????????<000007?<003?>000001?8?>03?????????003?803?001?<003?0???????????????<000007?<001?>000001?8?>03?????????003?803?001?<003?0???????????????<00000??8001??000001?8?>03?????????003?003?001?<003?0???????????????<00001??0000??800001?8?>03?????????003?003?001?<003?0???????????????<00001??0000??800001?8?>01?????????003?003?000?<003?0???????????????<00003?>00007?<00001?8?>01????????>003?003?000?<003?0???????????????<0000??<00003??00001?8?>00????????>003?003?0007<003?0???????????????80000??<00001??00001?8?>007???????<003?003?0001<003?08000001?<00000000001??800001??80001?8?>001???????0007?003?00004003?08000000?<00000000003??800000??>0001?8?>00000000000007?003?00000003?08000000?<0000000000???0000007??0001?8?>00000000000007?003?80000003?88000000?<0000000001??<0000003??8001?8?>00000000000007?003?80000003?88000000?<0000000007??<0000003??>001?8?>00000000000007?003?80000003?88000000?<000000000???80000001???001?8?>00000000000007?003?<0000001?<8000000?<000000003???00000000???<01?8?>0000000000000??003?>0000001?<8000000?<000000007??>000000007??>01?8?>07?????????80?>001???????81?<8000000?<00000000???<000000003???01?8?>07?????????80?>001???????80?<8000000?<00000000???8000000001???01?8?>07?????????80?>001???????80?<8000000?<00000000???0000000000???01?8?>07?????????80?<000???????807<8000000?<00000000??>00000000007??01?8?>07?????????80?8000???????807<8000000?<00000000??800000000001??01?0?>07?????????80?80007??????803<8000000?<00000000?>000000000000??0000?>07?????????80?00003??????800<???????????????????????????????????????????????????????????????????<???????????????????????????????????????????????????????????????????<|}"; // logo
//            String commandNameText = "{PC000;0041,0074,15,15,r,00,B=资产编码:YSGZ-10000-YWJS20113-YJ285|}"; // 编码
//            String commandCodeText = "{PC001;0041,0147,15,15,r,00,B=资产名称:特定流量服务器（固网）|}"; // 名称
//            String commandTypeText = "{PC002;0041,0237,15,15,r,00,B=资产类别:服务器|}"; // 类别
            String commandPrint = "{XS;I,0001,0002C4200,S01|}"; // 打印
            byte[] result = new byte[1];

            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandStatus.getBytes(StandardCharsets.UTF_8), commandStatus.length(), result);
            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandBackFeed.getBytes(StandardCharsets.UTF_8), commandBackFeed.length(), result);
            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandRead.getBytes(StandardCharsets.UTF_8), commandRead.length(), result);
//            try {
//                UsbHub hub = UsbHostManager.getUsbServices().getRootUsbHub();
//                UsbDevice device = UsbDeviceUtil.findDevice(hub, "08A6", "B002");
//                UsbDeviceUtil.initUseDevice(device);
//            } catch (UsbException e) {
//                e.printStackTrace();
//            }
            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandBeforeFeed.getBytes(StandardCharsets.UTF_8), commandBeforeFeed.length(), result);
            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandTagSize.getBytes(StandardCharsets.UTF_8), commandTagSize.length(), result);
            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandAY.getBytes(StandardCharsets.UTF_8), commandAY.length(), result);
            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandCleanCash.getBytes(StandardCharsets.UTF_8), commandCleanCash.length(), result);
//            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandLogo.getBytes(StandardCharsets.UTF_8), commandLogo.length(), result);
//            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandNameText.getBytes(StandardCharsets.UTF_8), commandNameText.length(), result);
//            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandCodeText.getBytes(StandardCharsets.UTF_8), commandCodeText.length(), result);
//            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandTypeText.getBytes(StandardCharsets.UTF_8), commandTypeText.length(), result);
            MyWinspool.INSTANCE.WritePrinter(handle.getValue(), commandPrint.getBytes(StandardCharsets.UTF_8), commandPrint.length(), result);
            MyWinspool.INSTANCE.EndPagePrinter(handle.getValue());
            MyWinspool.INSTANCE.EndDocPrinter(handle.getValue());
            boolean closed = Winspool.INSTANCE.ClosePrinter(handle.getValue());
            System.out.println(closed);
        }catch (Exception e){
            System.out.println(e.getMessage());
        }
    }
}
